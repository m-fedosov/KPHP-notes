Кратко о DNS:
<iframe width="560" height="315" src="https://www.youtube.com/embed/t2NMbSarXC4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

Самый простой вопрос, что нужно знать, чтобы отправить пакет в интернете?
Ответ - **знать адрес получателя**

## Окей, как узнать адрес получателя?

Набрав адрес нашей IT базы знаний wiki.merionet.ru в браузере и нажав enter, вы не сразу попадаете на ДНС сервер.

Сначала ваш девайс проверит кэш браузера или операционной системы. Ведь если вы до этого посещали сайт, то запись о нем останется локально в кэше, чтобы в последующие разы не тратить время на поиск, гоняя туда-сюда пакеты. Если ты частый гость в нашей IT базе знаний, то так оно и работает.

А вот если сайт оказался новым, тогда мы шлем запрос так называемому **resolver** (распознающему) DNS серверу. Обычно этот сервер находится у нашего интернет провайдера, но мы можем поменять его на другой, например, использовать, известные сервера четыре восьмерки (8.8.8.8) и четыре единицы (1.1.1.1).

> *Это часто на PlayStation советуют делать, когда скорость интеренета проседаед - имхо, какая-то дичь*

**Resolver** - делает сопоставление пришедшего имени сайта и его адреса в своем кэше. Если находит, то отвечает нам, а если не находит, то мы начинаем наш поход в поисках адреса и резолвер шлет запрос к корневому root серверу.

## Root server

Это сервер, который находится на самом верху DNS иерархии. Можно сказать, Шао Кан во вселенной DNS. Важно сказать, что рут сервер не один, их множество.

![[chart.png]]

Но этот сервер нам IP - адреса не скажет. Он лишь скажет нам к какому серверу обратиться дальше. Как регистратура, в поликлинике

Это нужно для разветвления поиска, чтобы не искать IP в общей куче, а уйти в нужную ветку.

А дальше нам нужно обратиться к нужному серверу верхнего уровня или **TLD (top level domain)** серверу. 

## TLD
Домены верхнего уровня - это то что идет после последней точки .com, .org, .ru, .net. 

**Generic Top Level Domain (gTLD)**, которые не привязаны к стране, например, .edu (образование), .com (коммерческие веб сайты), и ai (организации, связанные с искусственным интеллектом)

**Country Code Top Level Domain (ccTLD)**, которые привязаны к стране: .ru (Россия), .us (США) и .uk (Британия)

TLD так-то тоже не хранит все адреса. Подуставший резолвер теперь идет к ccTLD и спрашивает: "Ну что там дальше то?" А дальше его отправляют на уровень ниже - к серверу **авторитативных имен (Authoritative nameserver)**, который уже скажет нам нужный IP - адрес. Успех! Ну или нет. Он так же может ничего не найти и ответить, что - то в формате "извините, ваш сайт поглотила черная дыра."

В общем путь выглядит как-то так:
![[Pasted image 20230103164053.png]]

На обратном путирезолвер запишет адрес в кэш, чтобы снова не проходить по той же цепочке.

В терминологии DNS существует три типа запросов:

-   **Recursive (рекурсивный)** - это запрос формата: "Пришли мне IP-адрес сайта wiki.merionet.ru"
-   **Iterative (итеративный)** - это запрос формата: "Пришли мне IP-адрес сайта wiki.merionet.ru либо авторитативный DNS сервер"
-   **Inverse (обратный) -** спрашивает все наоборот: "Какое доменное имя у такого-то IP - адреса?"

Вот-с остаётся ~~всего-лишь~~ понять по какому маршруту нужно отправить пакет для полученного IP

Заметки:
> Вообще здесь немного запутано кто такой resolver, то ли он идёт перед DNS провайдером, то ли после, но сути дела это особо не меняет
> -
> Подробнее про доменные имена:
> https://developer.mozilla.org/ru/docs/Learn/Common_questions/What_is_a_domain_name

